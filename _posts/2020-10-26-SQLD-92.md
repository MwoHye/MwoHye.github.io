---
title: "SQLD 핵심노트 (1/2)"
categories:
  - SQL
tags:
  - SQL
  - SQLD
  - 자격증
last_modified_at: 2021-10-26T13:01:27-05:00
---

&nbsp;
# SQL 명령문 개괄

## ★ SQL 연산 순서
 
SELECT      -- 5\
FROM        -- 1\
WHERE       -- 2\
GROUP BY    -- 3\
HAVING      -- 4\
ORDER BY    -- 6

## DML
- SELECT, DELETE, UPDATE, INSERT

## DDL
- CREATE, DROP, ALTER, RENAME, TRUNCATE

## DCL
- REVOKE, GRANT

## TCL
- COMMIT, ROLLBACK, SAVEPOINT

&nbsp;
# SELECT절

## alias

1. SELECT 절에 쓰는 경우
- as 생략 가능
- 컬럼명에 띄어쓰기 할땐 "직원 번호"

2. FROM 절 : alias 사용 불가

## CONCAT 연산자

- CONCAT("a", "b") 인수는 반드시 2개만 가능
- ORACLE 연결 연산자 : 컬럼명1 || 컬럼명2
- SQL Server 연결연산자 : 컬럼명1 + 컬럼명2

&nbsp;
# SQL 연산자

- A IN (1,2,3) -> A = 1 or A = 2 or A = 3
- LIKE에 쓰이는 와일드카드 
  - _ : 미지의 한 글자
  - % : 0 이상 글자
  - ESCAPE : 와일드 카드가 아닌 문자 그대로 인식하게 함. 문자는 아무거나 상관없음
  ```sql
  SELECT * FROM EMP WHERE ENAME LIKE '_A__';
  SELECT * FROM EMP WHERE ENAME LIKE '%A%';
  SELECT * FROM EMP WHERE ENAME LIKE 'A@_A' ESCAPE '@'; -- 'A_A'라는 문자열 찾기, _를 문자열 취급
  ```
- ROWNUM (ORACLE)
  - 가상으로 번호를 매겨서 같이 출력, alias 가능
  ```sql
  SELECT EMPNO, SAL
  FROM EMP
  WHERE ROWNUM <=3 -- 정렬 전에 ROWNUM이 실행, 
  ORDER BY SAL -- 추려진 3개 중에서만 ORDER BY 정렬
  ```

- TOP(n) (SQL Server)
  - 위에서부터 N번째 레코드까지 출력
  
&nbsp;
# ★★★ NULL

## 정의 : "부재, 모르는 값"

## 1. NULL의 산출연산 = NULL
- NULL + 2, NULL -4, NULL X NULL = NULL

## 2. NULL의 비교연산 = 알수 없음 (UNKNOWN)
- WHERE에 (NULL)이 들어가면 FALSE 취급

## 3. NULL을 오름차순 정렬하면
- ORACLE : 맨 처음에 나옴 (+ 무한대)
- SQL Server : 맨 마지막에 나옴 (- 무한대)

## 4. NVL, NVL2, ISNULL, NULLIF, COALESCE
- NVL(K,0) : K가 NULL이면 0으로 바꿈
- ISNULL(K,0) : K가 NULL이면 0으로 바꿈
- NVL2(K,1,-1) : K가 NULL이 아니면 1, NULL이면 -1
- NULLIF(K,J) : K와 J가 같으면 NULL, 같지 않으면 K
- COALESCE(값1, 값2...) : ROW 기준 NULL 아닌 첫 번째 값

&nbsp;
# 정렬

## 1. 정렬의 특성
- 가장 마지막에 실행
- 성능이 느려질 수 있음
- NULL 관계
- SELECT에 안 들어 있어도 사용 가능

## 2. 인수 두개 정렬
- SAL DESC, ENAME ESC : SAL이 같으면 ENAME 오름차순

&nbsp;
# 숫자 함수
- ROUND(137.94)
- CEIL/CEILING : 지정한 식보다 크거나(+) 작은(-) 최소 정수 반환
  - ORACLE : CEIL
  - SQL Server : CEILING 
  ```sql
  SELECT CEILING($123.45), CEILING($-123.45), CEILING($0.0);  
  -- 124.00    -123.00    0.00  
  ```

&nbsp;
# 문자열 함수
- INSTR : 특정 글자 위치 찾기
- SUBSTR : 특정 위치 글자 출력
- LPAD/RPAD : 문자열 왼/오른쪽을 특정 문자로 채워서 자리수 만큼 만듬
- LTRIM/RTRIM : 문자열 맨 왼/오른쪽 기준 특정 문자를 제거
  ```sql
  SELECT INSTR('Liverpool', 'o', 1, 1) FROM DUAL;
  -- INSTR(문자열, 찾는글자, 시작위치, 몇번째)
  -- 7
  SELECT SUBSTR('Liverpool', 6, 4)
  -- SUBSTR(문자열, 시작위치, 출력길이)
  -- pool
  SELECT LPAD('Liverpool', 5, '#') FROM DUAL;
  -- LPAD(문자열, 자리수, 채울문자)
  -- #####Liverpool
  SELECT LTRIM('Liverpool', 'L') FROM DUAL;
  -- LIRIM(문자열, 제거할문자)
  -- liverpool
  SELECT RTRIM('Liverpool', 'ol') FROM DUAL;
  -- RIRIM(문자열, 제거할문자)
  -- liverp <- o가 있는 만큼 제거됨
  ```

&nbsp;
# 날짜 함수
- TO_CHAR, TO_DATE
- SYSDATE (oracle)
- 날짜 데이터 + 숫자 : 숫자를 day로 인식

&nbsp;
# CASE 
- 조건에 ELSE 없을 떄는 NULL 출력

&nbsp;
# ★ 집계함수 : NULL과의 관계

| A    | B    | C |
|------|------|---|
| NULL | NULL | 1 |
| 3    | 2    | 2 |
| NULL | 2    | 3 |

```sql
SUM(A) -- 3
SUM(B) -- 4
COUNT(A) -- 1
COUNT(*) -- 3 
SUM(A) + SUM(B) + SUM(C)  -- 3 + 4 + 6 = 13
SUM(A+B+C) -- NULL + 7 + NULL = 7
```

&nbsp;
# GROUP BY
- 집약 가능, 그룹 수준으로 정보를 바꿈

&nbsp;
# JOIN
1. NATUAL JOIN, USING
- 중복된 컬럼 하나, 제일 앞에 등장
- Alias 사용 안됨
2. A LEFT OUTER JOIN B
- 왼쪽 전부 다 SELECT + B와 공통적인 부분 
3. FROM A, B, C
- A, B JOIN 후 테이블을 가지고 C와 JOIN

&nbsp;
# 서브쿼리

```sql
SELECT -- SCALAR (단일값)
FROM -- Inline view (메인 쿼리의 컬럼 사용 가능)
WHERE -- 거의 모든 서브쿼리 사용 가능 (중첩 서브쿼리)
GROUP BY -- X
HAVING -- 거의 모든 서브쿼리 사용 가능 (중첩 서브쿼리)
ORDER BY -- SCALSR (단일값)
```

&nbsp;
# 집합연산자
- UNION
- INTERSECT
- MINUS (except)
- UNION ALL : 중복 데이터 O, 정렬 작업 X, 빠르다


&nbsp;
# DDL, TCL

```sql
DELETE FROM EMP;
TRUNCATE TABLE EMP;
DROP TABLE EMP;
```

|          | DELETE | TRUNCATE | DROP |
|----------|--------|----------|------|
| 데이터   | 삭제   | 삭제     | 삭제 |
| 저장공간 | 유지   | 삭제     | 삭제 |
| 저장구조 | 유지   | 유지     | 삭제 |
| ROLLBACK | 가능   | 불가능   | 가능 |

&nbsp;
# DML

- SELECT, INSERT, UPDATE, DELETE, MERGE(신유형)


&nbsp;
# 제약조건

- PK : UNIQUE + NOT NULL
- UNIQUE
- NOT NULL

&nbsp;
# DCL

- GRANT
- REVOKE

&nbsp;
# VIEW
- 독편보


&nbsp;
# 그룹 함수

## AGGREGATE FUNCTION
- COUNT, MIN, MAX, AVG, SUM 등 집계 함수

## ★ GROUP BY FUNCTION 
https://godzz.tistory.com/30

- 하나의 SQL로 테이블을 한 번만 읽어서 빠르게 계산해주는 함수

- ROLL UP : 소그룹간의 소계 계산
  - ROLL(A,B) != ROLL(B,A) -- 인수의 순서에 영향을 받음
- CUBE : 결합 가능한 모든 값에 대한 집계 생성
  - CUBE(A,B) = CUBE(B,A)
- GROUPING SETS : 원하는 부분의 소계만 추출

<!-- - ROLL UP, CUBE, GROUPING SETS 구분법
1. 총합 행 X : GROUPING SETS
2. 총합 행 O
  1. 한쪽만 결과 나와서 계층 형태 보임 (행 수 적어보임) : ROLL UP
  2. 양쪽 결과 다 나옴 (행 수 많아보임) : CUBE -->

&nbsp;
# TCL
- COMMIT, ROLLBACK
